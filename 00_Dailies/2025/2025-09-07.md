用户想要使用现有的数据集（k562_gwps, rpe1, jurkat, k562,
  hepg2）来创建验证集，关键是要检查这些数据集中是否包含了验证集中需要预测的扰动（perturbations）。

  这是一个很好的思路，因为：
  1. 这些数据集都有完整的对照细胞和扰动细胞
  2. 如果它们包含了验证集需要的扰动，就可以用作ground truth
  3. 可以从对照细胞构建输入，用扰动细胞作为期望输出

  我需要帮用户：
  4. 检查validation template中需要预测哪些扰动
  5. 检查这些训练数据集中是否包含相同的扰动
  6. 如果有重叠，创建本地验证集
  7. 设置评估流程

  首先要检查competition_val_template.h5ad中包含什么扰动需求。

---
	(torch) sczd425@ln01:~/run/xinby/competition_support_set$ python check_temp.py 
	/data/home/sczd425/.conda/envs/torch/lib/python3.11/site-packages/anndata/_core/anndata.py:1791: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
	  utils.warn_names_duplicates("obs")
	=== Validation Template 分析 ===
	细胞数: 98927
	基因数: 18080
	Obs 列: ['target_gene', 'batch_var', 'cell_type']
	
	需要预测的扰动数量: 51
	需要预测的扰动列表:
	   1. PACSIN3
	   2. non-targeting
	   3. IGF1R
	   4. DOT1L
	   5. TUSC3
	   6. ZNF581
	   7. ITGAV
	   8. CENPB
	   9. MAT2A
	  10. MGST1
	  11. CTSV
	  12. VCL
	  13. CSK
	  14. HMGXB4
	  15. SMARCB1
	  16. HDAC8
	  17. CXCL12
	  18. JMJD8
	  19. STRAP
	  20. MTFR1
	  21. GNG12
	  22. MAX
	  23. THY1
	  24. WAC
	  25. SMARCE1
	  26. KLHDC2
	  27. ACLY
	  28. FUBP1
	  29. UQCRB
	  30. SLIRP
	  31. PAXIP1
	  32. ANXA6
	  33. COX6C
	  34. DPH2
	  35. EHMT1
	  36. ARPC2
	  37. HMGCR
	  38. JAZF1
	  39. HDAC3
	  40. USF2
	  41. COX4I1
	  42. NFE2L1
	  43. PPP2R3C
	  44. KRT18
	  45. SH3BP4
	  46. GSTZ1
	  47. TCF7L2
	  48. HTATSF1
	  49. EIF3H
	  50. ZNF598
	  51. SUPV3L1
	
	细胞类型分布:
	cell_type
	H1    98927
	Name: count, dtype: int64
	
	每个扰动的细胞数:
	target_gene
	non-targeting    38176
	SH3BP4            2925
	ZNF581            2502
	ANXA6             2496
	PACSIN3           2101
	MGST1             2096
	IGF1R             2056
	ITGAV             2034
	SLIRP             2000
	CTSV              1989
	MTFR1             1787
	KLHDC2            1763
	SMARCB1           1706
	PAXIP1            1644
	KRT18             1602
	EHMT1             1601
	HMGXB4            1594
	CSK               1572
	DOT1L             1484
	MAT2A             1428
	Name: count, dtype: int64
	
	扰动列表已保存到 validation_perturbations.csv
	
	需要预测的扰动: 51 个
	
	=== k562_gwps ===
	数据集扰动数: 184
	与验证集重叠: 48 个扰动
	重叠的扰动:
	  - ACLY: 90 cells
	  - ANXA6: 238 cells
	  - ARPC2: 483 cells
	  - CENPB: 228 cells
	  - COX4I1: 145 cells
	  - COX6C: 174 cells
	  - CSK: 150 cells
	  - CTSV: 231 cells
	  - DOT1L: 171 cells
	  - DPH2: 246 cells
	  - EHMT1: 135 cells
	  - EIF3H: 291 cells
	  - FUBP1: 68 cells
	  - GNG12: 192 cells
	  - GSTZ1: 169 cells
	  - HDAC3: 142 cells
	  - HDAC8: 133 cells
	  - HMGCR: 279 cells
	  - HMGXB4: 200 cells
	  - HTATSF1: 248 cells
	  - IGF1R: 252 cells
	  - ITGAV: 105 cells
	  - JAZF1: 460 cells
	  - JMJD8: 177 cells
	  - KLHDC2: 297 cells
	  - KRT18: 223 cells
	  - MAT2A: 76 cells
	  - MAX: 211 cells
	  - MGST1: 217 cells
	  - MTFR1: 198 cells
	  - NFE2L1: 93 cells
	  - PACSIN3: 193 cells
	  - PAXIP1: 128 cells
	  - PPP2R3C: 137 cells
	  - SLIRP: 49 cells
	  - SMARCB1: 431 cells
	  - SMARCE1: 46 cells
	  - STRAP: 231 cells
	  - SUPV3L1: 154 cells
	  - TCF7L2: 185 cells
	  - TUSC3: 253 cells
	  - UQCRB: 208 cells
	  - USF2: 409 cells
	  - VCL: 246 cells
	  - WAC: 331 cells
	  - ZNF581: 208 cells
	  - ZNF598: 125 cells
	  - non-targeting: 75328 cells
	对照细胞: 75328

=== rpe1 ===
数据集扰动数: 69
与验证集重叠: 19 个扰动
重叠的扰动:
  - ARPC2: 140 cells
  - COX6C: 132 cells
  - DPH2: 57 cells
  - EIF3H: 19 cells
  - HDAC3: 59 cells
  - HMGCR: 45 cells
  - HTATSF1: 61 cells
  - JAZF1: 237 cells
  - MAT2A: 160 cells
  - MAX: 89 cells
  - PPP2R3C: 134 cells
  - SMARCB1: 141 cells
  - SMARCE1: 51 cells
  - STRAP: 69 cells
  - SUPV3L1: 101 cells
  - UQCRB: 119 cells
  - USF2: 105 cells
  - WAC: 115 cells
  - non-targeting: 11485 cells
对照细胞: 11485

=== jurkat ===
数据集扰动数: 69
与验证集重叠: 19 个扰动
重叠的扰动:
  - ARPC2: 140 cells
  - COX6C: 92 cells
  - DPH2: 68 cells
  - EIF3H: 51 cells
  - HDAC3: 120 cells
  - HMGCR: 8 cells
  - HTATSF1: 88 cells
  - JAZF1: 265 cells
  - MAT2A: 45 cells
  - MAX: 78 cells
  - PPP2R3C: 76 cells
  - SMARCB1: 204 cells
  - SMARCE1: 73 cells
  - STRAP: 94 cells
  - SUPV3L1: 76 cells
  - UQCRB: 89 cells
  - USF2: 141 cells
  - WAC: 56 cells
  - non-targeting: 12013 cells
对照细胞: 12013

=== k562 ===
数据集扰动数: 54
与验证集重叠: 19 个扰动
重叠的扰动:
  - ARPC2: 227 cells
  - COX6C: 117 cells
  - DPH2: 164 cells
  - EIF3H: 369 cells
  - HDAC3: 60 cells
  - HMGCR: 166 cells
  - HTATSF1: 96 cells
  - JAZF1: 209 cells
  - MAT2A: 52 cells
  - MAX: 180 cells
  - PPP2R3C: 52 cells
  - SMARCB1: 182 cells
  - SMARCE1: 31 cells
  - STRAP: 106 cells
  - SUPV3L1: 80 cells
  - UQCRB: 96 cells
  - USF2: 185 cells
  - WAC: 162 cells
  - non-targeting: 10691 cells
对照细胞: 10691

=== hepg2 ===
数据集扰动数: 69
与验证集重叠: 19 个扰动
重叠的扰动:
  - ARPC2: 99 cells
  - COX6C: 24 cells
  - DPH2: 52 cells
  - EIF3H: 10 cells
  - HDAC3: 42 cells
  - HMGCR: 29 cells
  - HTATSF1: 32 cells
  - JAZF1: 153 cells
  - MAT2A: 104 cells
  - MAX: 47 cells
  - PPP2R3C: 38 cells
  - SMARCB1: 81 cells
  - SMARCE1: 12 cells
  - STRAP: 46 cells
  - SUPV3L1: 29 cells
  - UQCRB: 24 cells
  - USF2: 54 cells
  - WAC: 38 cells
  - non-targeting: 4976 cells
对照细胞: 4976
Traceback (most recent call last):
  File "/data/run01/sczd425/xinby/competition_support_set/check_pert_overlap.py", line 55, in <module>
    json.dump(overlap_results, f, indent=2)
  File "/data/home/sczd425/.conda/envs/torch/lib/python3.11/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/data/home/sczd425/.conda/envs/torch/lib/python3.11/json/encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/data/home/sczd425/.conda/envs/torch/lib/python3.11/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/data/home/sczd425/.conda/envs/torch/lib/python3.11/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/data/home/sczd425/.conda/envs/torch/lib/python3.11/json/encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "/data/home/sczd425/.conda/envs/torch/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type int64 is not JSON serializable