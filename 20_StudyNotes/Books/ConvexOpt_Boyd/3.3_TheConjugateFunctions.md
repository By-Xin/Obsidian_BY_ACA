# Section 3.3: The Conjugate Functions

正常情况下, 我们可以通过一系列点的坐标 $(x, f(x))$ 来描述一条曲线, 然而我们也可以用一系列切线来描述该曲线, 共轭函数 (conjugate function) 就是这样一种描述方式.

## Definitions and Examples

***Definition* (Conjugate Function)**: 对于函数 $f(\mathbf{x}): \mathbb{R}^n \to \mathbb{R}$, 其共轭函数 (conjugate function) $f^*(\mathbf{y}):\mathbb{R}^n \to \mathbb{R}$ 定义为:
$$f^*(\mathbf{y})=\sup_{\mathbf{x}\in\mathrm{dom}f}\big(\mathbf{y}^\top \mathbf{x}-f(\mathbf{x})\big).$$
- 注意这里的 $\mathbf{y}$ 并不是 $y=f(\mathbf{x})$ 的 notation, 而是 conjugate function 的自变量.

![](https://raw.githubusercontent.com/By-Xin/Blog-figs/main/202601191723670.png)


***Example* (Economic Interpretation)**: 对于共轭函数的理解可以从经济学角度出发.
- 假设我们有一个生产者, 原变量 $\mathbf{x}$ 表示其产量, 目标函数 $f(\mathbf{x})$ 表示其总生产成本. 通常假设(但是数学上并不必要) $f(\mathbf{x})$ 是 convex 的, 这反映在经济学上为边际成本递增. 
- 记变量 $\mathbf{p}$ 为市场价格. 作为理性生产者, 其希望最大化利润:
  $$
  \sup_{\mathbf{x}\ge0} \{\mathbf{p}^\top \mathbf{x} - f(\mathbf{x})\}
  $$
 这个最大利润即为共轭函数 $f^*(\mathbf{p})$. 在当前语境下, 其含义即为在给定市场价格 $\mathbf{p}$ 下, 生产者愿意生产的最大利润.

***Example* (Conjugate Examples of some convex functions on $\mathbb{R}$)**

- *Affine Function* $f(x) = ax+b$
  - 对于任意 $y$, $yx-ax-b = (y-a)x-b$, 因此只有当 $y=a$ 时, 函数是有界的, 即 $f^*(y)\mid_{y=a} = -b$. 
  - 其余情况下, $f^*(y) = +\infty$. 因此 $f^*(y)$ 的定义域为单点 $\{a\}$, 且 $f^*(a) = -b$.
- *Negative Logarithm* $f(x) = -\log(x)$
  - 其定义域 $\text{dom}f = \mathbb{R}_{++}$, 对于任意 $y$, $yx+\log(x)$ 的极值点在 $x = - 1/y$.
  - 因此 $f^*(y) = -1 - \log(-y)$, 其定义域 $\text{dom}f^* = \{y|y<0\} = -\mathbb{R}_{++}$.
- *Exponential Function* $f(x) = e^x$
  - 对于任意 $y$, 考虑 $yx-e^x$. 若 $y < 0$, 则 $yx-e^x$ 无界; 若 $y > 0$, 则 $yx-e^x$ 在 $x = \log(y)$ 处取极值 $f^*(y) = y\log(y) - y$.
  - 因此 $f^*(y)$ 的定义域为 $\mathbb{R}_+$ 且 $f^*(y) = y\log(y) - y ~(\text{for } y>0)$, $f^*(0) = 0$.
- *Negative Entropy* $f(x) = x\log(x)$
  - 其定义域 $\text{dom}f = \mathbb{R}_{++}$, 对于任意 $y$, $yx-x\log(x)$ 的极值点在 $x = e^{y-1}$, 因此 $f^*(y) = e^{y-1}$.
  - 因此 $f^*(y)$ 的定义域为 $\mathbb{R}_{++}$ 且 $f^*(y) = e^{y-1}$.

***Example* (Conjugate of Quadratic Function)**: 考虑 $f(x) = \frac{1}{2}\mathbf{x}^\top Q \mathbf{x}$, 其中 $Q\in \mathbb{S}^n_{++}$ (即 $Q$ 是 $n$ 阶实对称正定矩阵). 

- 故对任意 $\mathbf{y}\in\mathbb{R}^n$, 考虑 $\mathbf{y}^\top \mathbf{x} - \frac{1}{2}\mathbf{x}^\top Q \mathbf{x}$ 的极值点. 

- 求其关于 $\mathbf{x}$ 的梯度并令其为零, 得到 $\nabla_{\mathbf{x}}(\mathbf{y}^\top \mathbf{x} - \frac{1}{2}\mathbf{x}^\top Q \mathbf{x}) = \mathbf{y} - Q\mathbf{x} = 0$, 即 $\mathbf{x}^* = Q^{-1}\mathbf{y}$.

  - 由于 $Q$ 正定, 故 $Q^{-1}$ 存在.
  - 由于 $f$ 是严格凸函数, 故 $\mathbf{x}^* = Q^{-1}\mathbf{y}$ 是唯一解.

- 因此 $f^*(\mathbf{y}) = \frac{1}{2}\mathbf{y}^\top Q^{-1}\mathbf{y}$.

***Example* (Conjugate of Log-determinant Function)**: 考虑 $X\in \mathbb{S}^n_{++}$, 
$$f(X) = \log(\det(\mathbf{X}^{-1})) = -\log\det(X)$$
其共轭函数为
$$f^*(\mathbf{Y}) = \sup_{\mathbf{X}\succ 0} \left\{ \mathbf{Y}^\top \mathbf{X}+ \log(\det(\mathbf{X})) \right\}$$

- 该等式可以立即整理为 
  $$f^*(\mathbf{Y})=\sup_{\mathbf{X}\succ 0} \left\{ \text{tr}(\mathbf{Y}\mathbf{X}) +\log(\det(\mathbf{X})) \right\}$$
  - 这是由于在矩阵空间 $\mathbb{S}^n$ (所有 $n$ 阶实对称矩阵构成的集合) 上, 标准内积可由 trace 定义: $\langle \mathbf{A}, \mathbf{B} \rangle = \text{tr}(\mathbf{A}^\top \mathbf{B})$. 

- 可以证明, 除非 $\mathbf{Y} \prec 0$ (负定), 否则 $f^*(\mathbf{Y}) = +\infty$. 

- 当 $\mathbf{Y}\prec 0$ 时, 令 $g(\mathbf{X}) = \text{tr}(\mathbf{Y}\mathbf{X}) +\log(\det(\mathbf{X}))$, 故求解其最优解: $\nabla_{\mathbf{X}}g = \nabla_{\mathbf{X}} \text{tr}(\mathbf{YX}) + \nabla_{\mathbf{X}}\log\det(\mathbf{X})$.

  - $\nabla_{\mathbf{X}}\text{tr}(\mathbf{YX})= \mathbf{Y}$.
  - $\nabla_{