---
aliases: [实验规范, Experiment Best Practice, 科研工程化]
tags:
  - toolbox
  - engineering
  - best-practice
---

# 实验行动手册

#### 1. 配置解耦 (Config Decoupling)

**原则**：严禁在代码中“硬编码”超参数（Hard Code）。

1. **参数剥离**：将所有可变参数（如 `lr`、`batch_size`、`epoch` 等）从代码逻辑中移除。
    
2. **传参方式**：必须通过以下两种方式之一传入参数：
    - `argparse`（命令行参数）  
    - `.yaml` / `.json` （配置文件）

3. **自动备份**：代码中必须包含相应逻辑，在每次实验运行时，自动保存一份**当前配置的副本**（如 `config.yaml`）到本次实验的输出目录中。


#### 2. 代码指纹记录 (Git Commit ID)

**原则**：必须记录“跑这份参数时的代码长什么样”。

1. **植入代码**：在训练脚本（`train.py`）的开头，加入自动获取并记录当前 `Git Commit Hash` 的代码段。

2. **日志打印**：确保在日志（Log）的开头显式打印如下信息：`Current Code Version: [Git Hash]`

3. **复现操作**：未来若需复现，只需执行 `git checkout [Hash]` 即可回到当时的代码环境。

#### 3. 建立标准化目录结构 (Structure)

**原则**：拒绝根目录堆放，层级必须清晰。

1. **总目录**：建立一个名为 `work_dirs` 的文件夹用于存放所有实验结果。

2. **实验文件夹命名规范**：
    - **格式**：`时间戳_模型名称_关键改动`
    - **正确示例**：`20251126_resnet50_add_se_block_lr0.01`
    - **错误示例**：`exp1`, `test_final`

3. **单次实验文件夹内必备清单**：
    - `config.yaml`：当时的配置副本（自动生成）。
    - `log.txt`：完整的训练日志（自动生成）。
    - `best.pth` / `result.csv`：训练得出的最优权重文件或实验的结果文件
    - `train.py` (可选)：直接备份一份当次运行的主代码，作为Git的补充双保险。

#### 4. 日志内容核对表 (Log Checklist)

**原则**：`log.txt` 的**开头**必须包含完整的环境上下文，缺一不可。

请在代码初始化阶段，按顺序写入以下信息到日志文件头部：
1. **Command**：运行这行代码的完整终端指令（便于直接复制重跑）。
2. **Environment**：
    - PyTorch 版本
    - CUDA 版本
    - 显卡型号
3. **Seed**：当前使用的随机种子具体数值。
4. **Git Hash**：当前的代码版本号。
5. **Config**：所有超参数的完整列表打印。