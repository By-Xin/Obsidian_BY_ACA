(torch) sczd425@ln01:~/run/xinby/vcc_local$ cd /data/home/sczd425/run/xinby/vcc_local && python stage2_build_baseline.py | cat
ğŸ¯ é˜¶æ®µ2: æ„å»ºå¹¶äº§å‡º'cell-mean baseline'
ä¸¥æ ¼æŒ‰ç…§VCCè§„èŒƒæ„å»ºbaselineé¢„æµ‹æ–‡ä»¶
============================================================
ğŸ”§ æ­¥éª¤1: ç¯å¢ƒå‡†å¤‡å®Œæˆ (éšæœºç§å­: 2025)

ğŸ“‚ åŠ è½½æ•°æ®...
  è®­ç»ƒé›†: splits/train_fixed.h5ad
  éªŒè¯é›†: splits/val_fixed.h5ad
  è®­ç»ƒé›†å½¢çŠ¶: (11326, 18080)
  éªŒè¯é›†å½¢çŠ¶: (6115, 18080)
ğŸ” æ­¥éª¤2: ä¸€è‡´æ€§ä¸å‰ç½®æ£€æŸ¥...
ä¸€è‡´æ€§æ£€æŸ¥ç»“æœ:
==================================================
âœ“ è®­ç»ƒé›†åŸºå› é¡ºåº: 18080ä¸ªåŸºå› 
âœ“ éªŒè¯é›†åŸºå› é¡ºåº: 18080ä¸ªåŸºå› 
âœ“ è®­ç»ƒ-éªŒè¯åŸºå› ä¸€è‡´: åŸºå› é¡ºåºåŒ¹é…
âœ“ è®­ç»ƒé›†æ•°æ®ç±»å‹: float32
âœ“ éªŒè¯é›†æ•°æ®ç±»å‹: float32
âœ“ è®­ç»ƒé›†åŸºå› æ•°: 18080
âœ“ éªŒè¯é›†åŸºå› æ•°: 18080
âœ“ è®­ç»ƒé›†target_gene: å­˜åœ¨
âœ“ éªŒè¯é›†target_gene: å­˜åœ¨
âœ“ è®­ç»ƒé›†æ§åˆ¶ç»†èƒ: å­˜åœ¨non-targeting
âœ“ éªŒè¯é›†æ§åˆ¶ç»†èƒ: å­˜åœ¨non-targeting
âœ“ è®­ç»ƒé›†log1pé‡çº²: p95=1.437

ä¸€è‡´æ€§æ£€æŸ¥: âœ… é€šè¿‡

ğŸ“Š æ­¥éª¤3: è®¡ç®—å‡å€¼æ¨¡æ¿...
Î¼_pert: åŸºäº 3843 ä¸ªæ‰°åŠ¨ç»†èƒè®¡ç®—
  æ‰°åŠ¨ç±»å‹æ•°: 38
Î¼_ctrl: åŸºäº 7483 ä¸ªæ§åˆ¶ç»†èƒè®¡ç®—

é‡çº²å¥åº·åº¦æŒ‡æ ‡:
  Î¼_pert L1 èŒƒæ•°: 4271.1309
  Î¼_ctrl L1 èŒƒæ•°: 4293.7432
  Î¼_pert L2 èŒƒæ•°: 67.9446
  Î¼_ctrl L2 èŒƒæ•°: 68.7225
  å·®å¼‚ L1 èŒƒæ•°: 123.4811
  å·®å¼‚ L2 èŒƒæ•°: 2.0170

ğŸ¯ æ­¥éª¤4: ç”ŸæˆéªŒè¯é›†é€ç»†èƒé¢„æµ‹çŸ©é˜µ...
é¢„æµ‹çŸ©é˜µ: (6115, 18080)
  æ§åˆ¶ç»†èƒ: 3208 -> Î¼_ctrl
  æ‰°åŠ¨ç»†èƒ: 2907 -> Î¼_pert
  æ€»è®¡: 6115 = 6115
âœ… é¢„æµ‹AnnDataåˆ›å»ºå®Œæˆ: (6115, 18080)

âœ… é¢„æµ‹æ–‡ä»¶æ ¼å¼éªŒè¯...
é¢„æµ‹æ–‡ä»¶æ ¼å¼æ£€æŸ¥:
==================================================
âœ“ é¢„æµ‹çŸ©é˜µå½¢çŠ¶: (6115, 18080)
âœ“ Xæ•°æ®ç±»å‹: float32
âœ“ åŸºå› æ•°é‡: 18080
âœ“ åŸºå› é¡ºåºæ­£ç¡®: ä¸å®˜æ–¹ä¸€è‡´
âœ“ target_geneåˆ—: å­˜åœ¨
âœ“ æ§åˆ¶ç»†èƒ: åŒ…å«non-targeting
âœ“ target_geneä¸€è‡´: ä¸éªŒè¯é›†ç›¸åŒ
âœ“ ç»†èƒæ•°é‡é™åˆ¶: 6115 â‰¤ 100,000
âœ“ æ•°æ®éè´Ÿ: ç¬¦åˆlog1pè¦æ±‚

æ ¼å¼éªŒè¯: âœ… é€šè¿‡

ğŸ’¾ ä¿å­˜baselineé¢„æµ‹å’Œç»Ÿè®¡...
âœ… é¢„æµ‹æ–‡ä»¶: predictions/baseline_pred_val_fixed.h5ad
âœ… ç»Ÿè®¡æ–‡ä»¶: predictions/baseline_stats.json
âœ… è¯¦ç»†æŠ¥å‘Š: reports/stage2_baseline_generation_report.txt

ğŸ‰ é˜¶æ®µ2å®Œæˆ!
âœ… é¢„æµ‹æ–‡ä»¶: predictions/baseline_pred_val_fixed.h5ad
âœ… ç»Ÿè®¡æ–‡ä»¶: predictions/baseline_stats.json
âœ… æŠ¥å‘Šæ–‡ä»¶: reports/stage2_baseline_generation_report.txt

ğŸ¯ ä¸‹ä¸€æ­¥:
1. è¿è¡Œ cell-eval prep ç”Ÿæˆ .vcc æ–‡ä»¶
2. æ‰§è¡Œæœ¬åœ°baselineè¯„åˆ† (DES/PDS/MAE)
3. å‡†å¤‡é˜¶æ®µ3å®˜ç½‘è¯„åˆ†éªŒè¯