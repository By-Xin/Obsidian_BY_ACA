(torch) sczd425@ln01:~/run/xinby/local_score_0912$ python step2_train_val_split.py 
ЁЯЪА Step 2: цЮДх╗║шонч╗Г/щкМшпБцХ░цНоцЛЖхИЖ
щЪПцЬ║чзНхнР: 2025
ЁЯУВ хКаш╜╜цХ░цНо: data_raw/k562_standardized.h5ad
цХ░цНох╜вчК╢: (18465, 18080)
ЁЯФН хИЖцЮРцЙ░хКихИЖх╕Г...
цА╗цЙ░хКич▒╗хЮЛцХ░: 54
цА╗ч╗ЖшГЮцХ░: 18465
цОзхИ╢ч╗ЖшГЮцХ░: 10691
цЙ░хКич▒╗хЮЛцХ░: 53

хПпчФиф║ОщкМшпБчЪДцЙ░хКи (>=150ч╗ЖшГЮ):
цХ░щЗП: 21
хЙН10ф╕кцЙ░хКи:
target_gene
MED12     573
EIF3H     369
OXA1L     344
HIRA      341
DHX36     269
MED1      254
TMSB10    228
ARPC2     227
C1QBP     210
JAZF1     209

тЬЕ щАЙхоЪщкМшпБцЙ░хКи: 15ф╕к
  1. MED12: 573ч╗ЖшГЮ
  2. EIF3H: 369ч╗ЖшГЮ
  3. OXA1L: 344ч╗ЖшГЮ
  4. HIRA: 341ч╗ЖшГЮ
  5. DHX36: 269ч╗ЖшГЮ
  6. MED1: 254ч╗ЖшГЮ
  7. TMSB10: 228ч╗ЖшГЮ
  8. ARPC2: 227ч╗ЖшГЮ
  9. C1QBP: 210ч╗ЖшГЮ
  10. JAZF1: 209ч╗ЖшГЮ
  11. NDUFB6: 190ч╗ЖшГЮ
  12. USF2: 185ч╗ЖшГЮ
  13. SMARCB1: 182ч╗ЖшГЮ
  14. MAX: 180ч╗ЖшГЮ
  15. DNMT1: 170ч╗ЖшГЮ

ЁЯФД ш┐ЫшбМхИЖх▒ВцК╜ца╖...
цОзхИ╢ч╗ЖшГЮ: 7483шонч╗Г + 3208щкМшпБ

хдДчРЖщкМшпБцЙ░хКи:
  тЬЕ MED12: 373шонч╗Г + 200щкМшпБ
  тЬЕ EIF3H: 222шонч╗Г + 147щкМшпБ
  тЬЕ OXA1L: 207шонч╗Г + 137щкМшпБ
  тЬЕ HIRA: 205шонч╗Г + 136щкМшпБ
  тЬЕ DHX36: 162шонч╗Г + 107щкМшпБ
  тЬЕ MED1: 153шонч╗Г + 101щкМшпБ
  тЬЕ TMSB10: 137шонч╗Г + 91щкМшпБ
  тЬЕ ARPC2: 137шонч╗Г + 90щкМшпБ
  тЬЕ C1QBP: 126шонч╗Г + 84щкМшпБ
  тЬЕ JAZF1: 126шонч╗Г + 83щкМшпБ
  тЬЕ NDUFB6: 114шонч╗Г + 76щкМшпБ
  тЬЕ USF2: 111шонч╗Г + 74щкМшпБ
  тЬЕ SMARCB1: 110шонч╗Г + 72щкМшпБ
  тЬЕ MAX: 108шонч╗Г + 72щкМшпБ
  тЬЕ DNMT1: 102шонч╗Г + 68щкМшпБ

хдДчРЖхЙйф╜ЩцЙ░хКи (хЕищГишонч╗Г): 38ф╕к
  ATP6V0B: 147шонч╗Г
  ATP6V0C: 53шонч╗Г
  UQCRB: 96шонч╗Г
  NDUFB4: 166шонч╗Г
  MAU2: 66шонч╗Г
  LRPPRC: 110шонч╗Г
  SUPT4H1: 74шонч╗Г
  SUPV3L1: 80шонч╗Г
  MBTPS1: 68шонч╗Г
  HDAC3: 60шонч╗Г
  MAT2A: 52шонч╗Г
  RNF20: 124шонч╗Г
  SMARCE1: 31шонч╗Г
  SSBP1: 119шонч╗Г
  METTL3: 138шонч╗Г
  TFAM: 82шонч╗Г
  SEC62: 5шонч╗Г
  DPH2: 164шонч╗Г
  UQCRQ: 166шонч╗Г
  SDC1: 170шонч╗Г
  COX6C: 117шонч╗Г
  SMAGP: 117шонч╗Г
  CHMP3: 130шонч╗Г
  FDPS: 10шонч╗Г
  EIF4B: 41шонч╗Г
  HTATSF1: 96шонч╗Г
  NISCH: 144шонч╗Г
  METTL17: 122шонч╗Г
  STRAP: 106шонч╗Г
  RRM1: 103шонч╗Г
  HMGCR: 166шонч╗Г
  KIF20A: 96шонч╗Г
  EWSR1: 48шонч╗Г
  METTL14: 121шонч╗Г
  DNAJA3: 127шонч╗Г
  PPP2R3C: 52шонч╗Г
  SLC25A3: 114шонч╗Г
  WAC: 162шонч╗Г

ЁЯУК цЛЖхИЖч╗Яшоб:
шонч╗Гч╗ЖшГЮцХ░: 13719
щкМшпБч╗ЖшГЮцХ░: 4746
щкМшпБч╗ЖшГЮцХ░щЩРхИ╢: 100000
тЬЕ щкМшпБч╗ЖшГЮцХ░чмжхРИшжБц▒В

ЁЯУБ хИЫх╗║цЛЖхИЖцХ░цНощЫЖ...
шонч╗ГщЫЖ: (13719, 18080)
шонч╗ГщЫЖцЙ░хКихИЖх╕Г:
target_gene
non-targeting    7483
MED12             373
EIF3H             222
OXA1L             207
HIRA              205
SDC1              170
HMGCR             166
UQCRQ             166
NDUFB4            166
DPH2              164
Name: count, dtype: int64

щкМшпБщЫЖ: (4746, 18080)
щкМшпБщЫЖцЙ░хКихИЖх╕Г:
target_gene
non-targeting    3208
MED12             200
EIF3H             147
OXA1L             137
HIRA              136
DHX36             107
MED1              101
TMSB10             91
ARPC2              90
C1QBP              84
JAZF1              83
NDUFB6             76
USF2               74
MAX                72
SMARCB1            72
DNMT1              68
Name: count, dtype: int64

тЬЕ щкМшпБцЛЖхИЖч╗УцЮЬ...
==================================================
тЬУ хЯ║хЫацХ░щЗПф╕АшЗ┤: шонч╗Г:18080, щкМшпБ:18080
тЬУ хЯ║хЫащб║х║Пф╕АшЗ┤: ф╕АшЗ┤
тЬУ цХ░цНоч▒╗хЮЛ: float32, float32
тЬУ щкМшпБцЙ░хКихМ╣щЕН: цЬЯцЬЫ15, хоЮщЩЕ15
тЬУ шонч╗ГщЫЖцОзхИ╢ч╗ЖшГЮ: 7483ф╕к
тЬУ щкМшпБщЫЖцОзхИ╢ч╗ЖшГЮ: 3208ф╕к
тЬУ ч╗ЖшГЮцЧащЗНхПа: цЧащЗНхПа

цА╗ф╜Уч╗УцЮЬ: тЬЕ щАЪш┐З

ЁЯТ╛ ф┐ЭхнШцЛЖхИЖцХ░цНо...
тЬЕ шонч╗ГщЫЖ: splits/train.h5ad
тЬЕ щкМшпБщЫЖ: splits/val.h5ad

ЁЯТ╛ ф┐ЭхнШцЛЖхИЖф┐бцБп...
тЬЕ щкМшпБхЯ║хЫахИЧшби: splits/validation_genes.csv
тЬЕ цЛЖхИЖч╗Яшоб: splits/split_statistics.csv
тЬЕ шпжч╗ЖцКехСК: reports/step2_split_report.txt

Step 2 Train-Val Split Report
==================================================
Random seed: 2025
Split date: 2025-09-12 15:39:45.090694

Training Set:
  Cells: 13719
  Genes: 18080
  Perturbations: 54
  Control cells: 7483

Validation Set:
  Cells: 4746
  Genes: 18080
  Perturbations: 16
  Control cells: 3208

Validation Perturbations:
  MED12: 200 cells
  EIF3H: 147 cells
  OXA1L: 137 cells
  HIRA: 136 cells
  DHX36: 107 cells
  MED1: 101 cells
  TMSB10: 91 cells
  ARPC2: 90 cells
  C1QBP: 84 cells
  JAZF1: 83 cells
  NDUFB6: 76 cells
  USF2: 74 cells
  MAX: 72 cells
  SMARCB1: 72 cells
  DNMT1: 68 cells

random_seed,total_genes,train_cells,val_cells,train_perturbations,val_perturbations,train_control_cells,val_control_cells

2025,18080,13719,4746,54,16,7483,3208

target_gene,train_cells,val_cells

MED12,373,200

EIF3H,222,147

OXA1L,207,137

HIRA,205,136

DHX36,162,107

MED1,153,101

TMSB10,137,91

ARPC2,137,90

C1QBP,126,84

JAZF1,126,83

NDUFB6,114,76

USF2,111,74

SMARCB1,110,72

MAX,108,72

DNMT1,102,68

